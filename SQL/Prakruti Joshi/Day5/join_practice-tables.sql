USE practice2

CREATE TABLE Employee
(
	EMPLOYEE_ID INT PRIMARY KEY IDENTITY(1,1),
	FIRST_NAME VARCHAR(30) NOT NULL,
	LAST_NAME VARCHAR(20) NOT NULL, 
	SALARY MONEY,
	JOINING_DATE DATETIME, 
	DEPARTMENT VARCHAR(20),
	MANAGER_ID INT
)

INSERT INTO Employee 
(FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT,MANAGER_ID)
VALUES 
('John','Abraham',1000000,'01-01-2013 12:00:00','Banking',null),
('Michael','Clarke0',800000,'01-01-2013 12:00:00','Insurance',1),
('Roy','Thomas',700000,'01-02-2013 12:00:00','Banking',1),
('Tom','Jose',600000,'01-02-2013 12:00:00','Insurance',2),
('Jerry','Pinto',650000,'01-02-2013 12:00:00','Insurance',3),
('Philip','Mathew',750000,'01-01-2013 12:00:00','Services',3),
('TestName1','123',650000,'01-01-2013 12:00:00','Services',2),
('TestName2','Lname%',600000,'01-02-2013 12:00:00','Insurance',2)


SELECT EMPLOYEE_ID,FIRST_NAME,LAST_NAME,SALARY,
JOINING_DATE=CONVERT(VARCHAR(30),JOINING_DATE,113), DEPARTMENT,MANAGER_ID
FROM Employee



SELECT * FROM Employee


CREATE TABLE Incentives
(
	EMPLOYEE_REF_ID INT,
	INCENTIVE_DATE DATE,
	INCENTIVE_AMOUNT MONEY
)

ALTER TABLE Incentives
   ADD CONSTRAINT empid_forkey FOREIGN KEY (EMPLOYEE_REF_ID)
      REFERENCES Employee (EMPLOYEE_ID)
          ON UPDATE CASCADE

INSERT INTO Incentives
(EMPLOYEE_REF_ID,INCENTIVE_DATE, INCENTIVE_AMOUNT)
VALUES 
(1,'01-02-13',5000),
(2,'01-02-13',3000),
(3,'01-02-13',4000)

SELECT EMPLOYEE_REF_ID,INCENTIVE_DATE, INCENTIVE_AMOUNT,
INCENTIVE_DATE=CONVERT(VARCHAR(30),INCENTIVE_DATE,106)
FROM Incentives

SELECT * FROM Incentives


--assignment1
SELECT FIRST_NAME,LAST_NAME,JOINING_DATE,INCENTIVE_DATE,
DATEDIFF(DAYOFYEAR,JOINING_DATE,INCENTIVE_DATE) AS 'Month_Difference'
FROM Employee e JOIN Incentives i
ON e.EMPLOYEE_ID=i.EMPLOYEE_REF_ID



--assignment2
SELECT  FIRST_NAME,INCENTIVE_AMOUNT
FROM Employee e INNER JOIN Incentives i
ON e.EMPLOYEE_ID=i.EMPLOYEE_REF_ID AND 
INCENTIVE_AMOUNT>3000

--assignment3
SELECT  FIRST_NAME,INCENTIVE_AMOUNT
FROM Employee e LEFT JOIN Incentives i
ON e.EMPLOYEE_ID=i.EMPLOYEE_REF_ID

--assignment4
SELECT mgr.FIRST_NAME AS 'Manager Name' , emp.FIRST_NAME AS 'Employee Name'
FROM Employee mgr JOIN Employee emp
ON mgr.EMPLOYEE_ID=emp.MANAGER_ID


--assignment5
SELECT  FIRST_NAME,ISNULL(INCENTIVE_AMOUNT,0)
FROM Employee e LEFT JOIN Incentives i
ON e.EMPLOYEE_ID=i.EMPLOYEE_REF_ID